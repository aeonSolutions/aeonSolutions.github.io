<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  

  <title>Editable Plots from R to PowerPoint</title>
  <meta name="description" content="<strong>In this post I am giving a quick overview of how to create editable plots
in PowerPoint from R. These plots are comprised of simple vector-based shapes
and thus allow you to change labels, colours, or text position in seconds.
 Your project managers will love it!</strong>

">
  <meta name="author" content="Laurens Geffert">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Editable Plots from R to PowerPoint">
  <meta name="twitter:description" content="<strong>In this post I am giving a quick overview of how to create editable plots
in PowerPoint from R. These plots are comprised of simple vector-based shapes
and thus allow you to change labels, colours, or text position in seconds.
 Your project managers will love it!</strong>

">
  
  <meta name="twitter:creator" content="JanLauGe">
  
  <meta name="twitter:image" content="/images/favicons/favicon-194x194.png" />

  <meta property="og:type" content="article">
  <meta property="og:title" content="Editable Plots from R to PowerPoint">
  <meta property="og:description" content="<strong>In this post I am giving a quick overview of how to create editable plots
in PowerPoint from R. These plots are comprised of simple vector-based shapes
and thus allow you to change labels, colours, or text position in seconds.
 Your project managers will love it!</strong>

">
  <meta property="og:image" content="/images/favicons/favicon-194x194.png" />

  <link rel="apple-touch-icon" sizes="57x57" href="images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="images/favicons/manifest.json">
  <link rel="shortcut icon" href="images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="css/main.css?1539431935741611000">
  <link rel="canonical" href="http://localhost:4000/2018/creating-editable-PowerPoint-plots-from-R/">
  <link rel="alternate" type="application/rss+xml" title="Laurens Geffert" href="feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="" title="link to home of Laurens Geffert">
          <img src="images/profile.png" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Laurens Geffert</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Data Science Portfolio</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">

      		  <!-- Blog Button -->
      		  <ul class="navigation">
      			  <li class="navigation__item"><a href="/index" title="Blog posts" class="blog-button">Blog</a></li>
      		  </ul>

      		  <!-- About Button -->
      		  <ul class="navigation">
      			  <li class="navigation__item"><a href="/about" title="About the author" class="blog-button">About</a></li>
      		  </ul>

      		  <!-- Blog Roll -->
      		  <ul class="navigation">
      			  <li class="navigation__item"><a href="/links" title="Links to other sites" class="blog-button">Links</a></li>
      		  </ul>

          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">

              
                <!-- GitHub -->
                <li class="navigation__item">
                  <a href="https://www.github.com/JanLauGe" title="JanLauGe on GitHub" target="_blank">
                    <i class="icon icon-social-github"></i>
                    <span class="label">GitHub</span>
                  </a>
                </li>
              

  			      
                <!-- Twitter -->
                <li class="navigation__item">
                  <a href="http://twitter.com/JanLauGe" title="@JanLauGe on Twitter" target="_blank">
                    <i class="icon icon-social-twitter"></i>
                    <span class="label">Twitter</span>
                  </a>
                </li>
              

              
                <!-- LinkedIn -->
                <li class="navigation__item">
                  <a href="https://www.linkedin.com/in/laurensgeffert" title="laurensgeffert on LinkedIn" target="_blank">
                    <i class="icon icon-social-linkedin"></i>
                    <span class="label">LinkedIn</span>
                  </a>
                </li>
              

        			
        			  <!-- Stackoverflow -->
        			  <li class="navigation__item">
        				  <a href="https://stackoverflow.com/users/5457259/janlauge" title="janlauge on StackOverflow" target="_blank">
        				    <i class="icon icon-social-stack-overflow"></i>
        				    <span class="label">Stackoverflow</span>
        				  </a>
        			  </li>
              

              
        			  <!-- Kaggle -->
        			  <li class="navigation__item">
        				  <a href="https://www.kaggle.com/janlauge" title="janlauge on Kaggle" target="_blank">
        				    <i class="icon icon-trophy"></i>
        				    <span class="label">Kaggle</span>
        				  </a>
        			  </li>
              

        			
        			  <!-- Googlescholar -->
        			  <li class="navigation__item">
                  <a href="https://scholar.google.co.uk/citations?user=_aqDDYYAAAAJ&hl=en" title="Laurens Geffert on Google Scholar" target="_blank">
                    <i class="icon icon-social-google-plus"></i>
                    <span class="label">Google Scholar</span>
                  </a>
                </li>
              

              

              
                <!-- Email -->
                <li class="navigation__item">
                  <a href="mailto:laurensgeffert@gmail.com" title="Email laurensgeffert@gmail.com" target="_blank">
                    <i class="icon icon-mail"></i>
                    <span class="label">Email</span>
                  </a>
                </li>
              

              <!-- RSS -->
              <li class="navigation__item">
                <a href="feed.xml" title="Subscribe" target="_blank">
                  <i class="icon icon-rss"></i>
                  <span class="label">RSS</span>
                </a>
              </li>

            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="24 Feb 2018" class="post-meta__date date">24 Feb 2018</time>
      
      &#8226; <span class="post-meta__tags">on <a href="tags/#DataScience">DataScience</a> <a href="tags/#R">R</a> <a href="tags/#Visualisation">Visualisation</a> </span>
      
    </div>
    <h1 class="post-title">Editable Plots from R to PowerPoint</h1>
  </header>

  <section class="post">
    <p><strong>In this post I am giving a quick overview of how to create editable plots
in PowerPoint from R. These plots are comprised of simple vector-based shapes
and thus allow you to change labels, colours, or text position in seconds.
 Your project managers will love it!</strong>
<!--more--></p>

<h2 id="motivation">Motivation</h2>
<p>R allows us to create great visualisations, but in most data science settings
these need to be presented to key stakeholders and decision makers in
presentations or “slideuments”. Having to make small changes to previously
compiled slots can be time consuming and frustrating. A solution to this common
problem is to keep your plots and graphs editable as a group of vector shapes
in PowerPoint. This way project managers or data scientists themselves can make
small changes without having to re-execute a single line of code.</p>

<h2 id="solution">Solution</h2>
<p>We will use a tidyverse approach for creating the plot. Furthermore, the
<code class="highlighter-rouge">officer</code> package enables us to smoothly interact with PowerPoint, and the <code class="highlighter-rouge">rvg</code>
package is required to save our plots as editable vector graphs.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">officer</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">rvg</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>For demonstration purposes, let’s create a plot using the diamonds dataset.
NB: I am saving the ggplot object to a variable name, but also displaying the
plot when executing the lines by appending the <code class="highlighter-rouge">; ggp</code> at the end.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Using diamonds dataset which is shipped with R</span><span class="w">
</span><span class="n">ggp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">diamonds</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Let's simplify things by only considering natural number carats</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">carat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">carat</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">carat</span><span class="p">,</span><span class="w"> </span><span class="n">cut</span><span class="p">,</span><span class="w"> </span><span class="n">clarity</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">price</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">price</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># Create a plot of price by carat, colour, cut, and clarity</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">carat</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">price</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">color</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'identity'</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_grid</span><span class="p">(</span><span class="n">cut</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">clarity</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="c1"># Simplify the plot layout a little</span><span class="w">
  </span><span class="n">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">guides</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.grid.major.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">(),</span><span class="w">
        </span><span class="n">panel.grid.minor.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_blank</span><span class="p">());</span><span class="w"> </span><span class="n">ggp</span><span class="w">
</span></code></pre></div></div>

<p><img src="http://localhost:4000/assets/ppplots_example.png" alt="Plot example" /></p>

<p>Now we can use <code class="highlighter-rouge">officer</code> to create a new PowerPoint document and
<code class="highlighter-rouge">rvg::ph_with_vg</code> to drop our ggplot object in there.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Create a new powerpoint document</span><span class="w">
</span><span class="n">doc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_pptx</span><span class="p">()</span><span class="w">
</span><span class="n">doc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">add_slide</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="s1">'Title and Content'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Office Theme'</span><span class="p">)</span><span class="w">

</span><span class="c1"># Add the plot</span><span class="w">
</span><span class="n">doc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ph_with_vg</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="n">ggobj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ggp</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'body'</span><span class="p">)</span><span class="w">  

</span><span class="c1"># Write the document to a file</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'plot.pptx'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Now open the document in PowerPoint. Right-click and ungroup the plot. Voila!
You should be able to select individual elements, for example the data bars in
the plot, change their colour, move them around, change the text in labels,
and much more. Have a look at the plot below. A cookie for you if you can
find all ten edits that I made in the example.</p>

<p><img src="http://localhost:4000/assets/ppplots_example_edited.png" alt="Plot example" /></p>

<p>As always, hope this is helpful. And FYI, I am still looking for a way to
achieve the same result using <code class="highlighter-rouge">Python</code>. If you know one, collect some bounty
<a href="https://stackoverflow.com/questions/48944296/editable-plots-in-powerpoint-from-python-equivalent-of-officer-and-rvg">here</a></p>

  </section>
  <section id="disqus_thread"></section><!-- /#disqus_thread -->
</article>

<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = 'https://janlauge.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2018 Laurens Geffert. All rights reserved.</span>
</footer>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="js/main.js?1539431935741611000"></script>


    </div>
  </body>
</html>